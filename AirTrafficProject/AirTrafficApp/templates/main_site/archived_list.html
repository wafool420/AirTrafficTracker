{% extends "main_site/layout.html" %}
{% block title %}Archived Data{% endblock %}

{% block content %}
<h1 class="text-center mt-4 fw-bold">Archived Datasets</h1>

{% for archived in archive %}
    <div class="container mt-4 p-3 border border-dark border-3 rounded">
        <p class="text-muted">Created on: {{ archived.date_created|date:"F j, Y - h:i A" }}</p>

        <table class="table table-striped table-bordered text-center">
            <thead>
                <tr>
                    <th>Log Date</th>
                    <th>Call Sign</th>
                    <th>Type of Aircraft</th>
                    <th>Detail</th>
                    <th>Origin</th>
                    <th>Destination</th>
                    <th>Movement</th>
                    <th>Time (UTC)</th>
                    <th>Timeliness</th>
                    <th>Remarks</th>
                    <th>Logged by</th>
                </tr>
            </thead>
            <tbody>
                {% for item in archived.items_set.all %}
                    <tr>
                        <td>{{ item.date|date:"m/d/y" }}</td>
                        <td>{{ item.call_sign }}</td>
                        <td>{{ item.aircraft_type }}</td>
                        <td>{{ item.detail }}</td>
                        <td>{{ item.origin }}</td>
                        <td>{{ item.destination }}</td>
                        <td>{{ item.action }}</td>
                        <td>{{ item.time }}</td>
                        <td>{{ item.timeliness }}</td>
                        <td>{{ item.remarks }}</td>
                        <td>{{ item.user.username }}</td>
                    </tr>
                {% empty %}
                    <tr><td colspan="11">No items in this archive group.</td></tr>
                {% endfor %}
            </tbody>
        </table>
        <h1 class="text-center mt-4 fw-bold"> Statistics</h1>
        <div class="text-center">
            <h4>Details</h2>
            <ul class="list-unstyled d-inline-block text-start">
                <li>Fixed Wing: {{ archived.fixed_wing_count }}</li>
                <li>Helicopter: {{ archived.helicopter_count }}</li>
            </ul>
        
            <h4 class="mt-3">Movement</h2>
            <ul class="list-unstyled d-inline-block text-start">
                <li>Arrival: {{ archived.arrival_count }}</li>
                <li>Departure: {{ archived.departure_count }}</li>
                <li>Enroute: {{ archived.enroute_count }}</li>
            </ul>
        
            <h4 class="mt-3">Timeliness</h2>
            <ul class="list-unstyled d-inline-block text-start">
                <li>Delayed: {{ archived.delayed_count }}</li>
                <li>On Time: {{ archived.ontime_count }}</li>
                <li>N/A: {{ archived.na_count }}</li>
            </ul>
        </div>
        
        <div class="d-flex justify-content-center gap-2 mt-4">
            <form method="POST" action="{% url 'delete_archive_group' archived.id %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm mb-3">Delete</button>
            </form>
        </div>

    </div>
    
    
{% empty %}
    <h4 class="text-center text-muted mt-5">No archived datasets available.</h4>
{% endfor %}
    
        
    





<div class="d-flex justify-content-center gap-2 mt-4">
    <form method="GET" action="{% url 'clear_archive' %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger btn-lg mb-3">Clear Archive</button>
    </form>
</div>
{% endblock %}
